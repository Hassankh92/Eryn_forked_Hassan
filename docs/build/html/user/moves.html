

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Moves &mdash; Eryn 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Priors" href="prior.html" />
    <link rel="prev" title="Backends" href="backend.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: coral" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Eryn
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ensemble.html">Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="state.html">State</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend.html">Backends</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Moves</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#move-parent-class">Move Parent Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metropolis-hastings-moves">Metropolis-Hastings Moves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mh-parent-class">MH Parent Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implemented-mh-moves">Implemented MH Moves</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#red-blue-moves">Red-Blue Moves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#red-blue-parent-class">Red-Blue Parent Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implemented-red-blue-moves">Implemented Red-Blue Moves</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reversible-jump-moves">Reversible Jump Moves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reversible-jump-parent-class">Reversible Jump Parent Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implemented-reversible-jump-moves">Implemented Reversible Jump Moves</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="prior.html">Priors</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/Eryn_tutorial.html">Getting Started with Eryn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/Eryn_tutorial.html#Utilities">Utilities</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Eryn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Moves</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/moves.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="prior.html" class="btn btn-neutral float-right" title="Priors" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="backend.html" class="btn btn-neutral float-left" title="Backends" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="moves">
<h1>Moves<a class="headerlink" href="#moves" title="Permalink to this headline">¶</a></h1>
<p>Proposal distributions for MCMC.</p>
<div class="section" id="move-parent-class">
<h2>Move Parent Class<a class="headerlink" href="#move-parent-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="eryn.moves.Move">
<em class="property">class </em><code class="sig-prename descclassname">eryn.moves.</code><code class="sig-name descname">Move</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature_control</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">periodic</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parent class for proposals or “moves”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>temperature_control</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tempering.TemperatureControl</span></code>, optional) – This object controls the tempering. It is passes to the parent class
to moves so that all proposals can share and use temperature settings.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
</dd>
</dl>
<dl class="py method">
<dt id="eryn.moves.Move.compute_log_posterior_basic">
<code class="sig-name descname">compute_log_posterior_basic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logl</span></em>, <em class="sig-param"><span class="n">logp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.Move.tune">
<code class="sig-name descname">tune</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">accepted</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.Move.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_state</span></em>, <em class="sig-param"><span class="n">new_state</span></em>, <em class="sig-param"><span class="n">accepted</span></em>, <em class="sig-param"><span class="n">subset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
necessary for global fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>old_state</strong> – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="metropolis-hastings-moves">
<h2>Metropolis-Hastings Moves<a class="headerlink" href="#metropolis-hastings-moves" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mh-parent-class">
<h3>MH Parent Class<a class="headerlink" href="#mh-parent-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="eryn.moves.MHMove">
<em class="property">class </em><code class="sig-prename descclassname">eryn.moves.</code><code class="sig-name descname">MHMove</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.move.Move</span></code></p>
<p>A general Metropolis-Hastings proposal</p>
<p>Concrete implementations can be made by providing a <code class="docutils literal notranslate"><span class="pre">get_proposal</span></code> method.
For standard Gaussian Metropolis moves, <code class="xref py py-class docutils literal notranslate"><span class="pre">moves.GaussianMove</span></code> can be used.</p>
<dl class="py method">
<dt id="eryn.moves.MHMove.get_proposal">
<code class="sig-name descname">get_proposal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">branches_coords</span></em>, <em class="sig-param"><span class="n">branches_inds</span></em>, <em class="sig-param"><span class="n">random</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Get proposal from distribution for MH proposal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[nwalkers, nleaves_max, ndim] representing
coordinates for walkers.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[nwalkers, nleaves_max] representing which
leaves are currently being used.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state object.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If proposal is not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.MHMove.propose">
<code class="sig-name descname">propose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.MHMove.compute_log_posterior_basic">
<code class="sig-name descname">compute_log_posterior_basic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logl</span></em>, <em class="sig-param"><span class="n">logp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.MHMove.tune">
<code class="sig-name descname">tune</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">accepted</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.MHMove.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_state</span></em>, <em class="sig-param"><span class="n">new_state</span></em>, <em class="sig-param"><span class="n">accepted</span></em>, <em class="sig-param"><span class="n">subset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
necessary for global fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>old_state</strong> – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="implemented-mh-moves">
<h3>Implemented MH Moves<a class="headerlink" href="#implemented-mh-moves" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="eryn.moves.GaussianMove">
<em class="property">class </em><code class="sig-prename descclassname">eryn.moves.</code><code class="sig-name descname">GaussianMove</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cov_all</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'vector'</span></em>, <em class="sig-param"><span class="n">factor</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.mh.MHMove</span></code></p>
<p>A Metropolis step with a Gaussian proposal function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cov</strong> – The covariance of the proposal function. This can be a scalar,
vector, or matrix and the proposal will be assumed isotropic,
axis-aligned, or general respectively.</p></li>
<li><p><strong>mode</strong> (<em>Optional</em>) – Select the method used for updating parameters. This
can be one of <code class="docutils literal notranslate"><span class="pre">&quot;vector&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;sequential&quot;</span></code>. The
<code class="docutils literal notranslate"><span class="pre">&quot;vector&quot;</span></code> mode updates all dimensions simultaneously,
<code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code> randomly selects a dimension and only updates that
one, and <code class="docutils literal notranslate"><span class="pre">&quot;sequential&quot;</span></code> loops over dimensions and updates each
one in turn.</p></li>
<li><p><strong>factor</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – If provided the proposal will be made with a
standard deviation uniformly selected from the range
<code class="docutils literal notranslate"><span class="pre">exp(U(-log(factor),</span> <span class="pre">log(factor)))</span> <span class="pre">*</span> <span class="pre">cov</span></code>. This is invalid for
the <code class="docutils literal notranslate"><span class="pre">&quot;vector&quot;</span></code> mode.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the proposal dimensions are invalid or if any of any of
    the other arguments are inconsistent.</p>
</dd>
</dl>
<dl class="py method">
<dt id="eryn.moves.GaussianMove.get_proposal">
<code class="sig-name descname">get_proposal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">branches_coords</span></em>, <em class="sig-param"><span class="n">branches_inds</span></em>, <em class="sig-param"><span class="n">random</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Get proposal from Gaussian distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[nwalkers, nleaves_max, ndim] representing
coordinates for walkers.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[nwalkers, nleaves_max] representing which
leaves are currently being used.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.GaussianMove.compute_log_posterior_basic">
<code class="sig-name descname">compute_log_posterior_basic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logl</span></em>, <em class="sig-param"><span class="n">logp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.GaussianMove.propose">
<code class="sig-name descname">propose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.GaussianMove.tune">
<code class="sig-name descname">tune</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">accepted</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.GaussianMove.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_state</span></em>, <em class="sig-param"><span class="n">new_state</span></em>, <em class="sig-param"><span class="n">accepted</span></em>, <em class="sig-param"><span class="n">subset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
necessary for global fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>old_state</strong> – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="red-blue-moves">
<h2>Red-Blue Moves<a class="headerlink" href="#red-blue-moves" title="Permalink to this headline">¶</a></h2>
<div class="section" id="red-blue-parent-class">
<h3>Red-Blue Parent Class<a class="headerlink" href="#red-blue-parent-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="eryn.moves.RedBlueMove">
<em class="property">class </em><code class="sig-prename descclassname">eryn.moves.</code><code class="sig-name descname">RedBlueMove</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nsplits</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">randomize_split</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">gibbs_sampling_leaves_per</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">live_dangerously</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.move.Move</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>An abstract red-blue ensemble move with parallelization as described in
<a class="reference external" href="https://arxiv.org/abs/1202.3665">Foreman-Mackey et al. (2013)</a>.</p>
<p># TODO: think about this for reversible jump.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nsplits</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of sub-ensembles to use. Each
sub-ensemble is updated in parallel using the other sets as the
complementary ensemble. The default value is <code class="docutils literal notranslate"><span class="pre">2</span></code> and you
probably won’t need to change that.</p></li>
<li><p><strong>randomize_split</strong> (<em>bool</em><em>, </em><em>optional</em>) – Randomly shuffle walkers between
sub-ensembles. The same number of walkers will be assigned to
each sub-ensemble on each iteration. By default, this is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>live_dangerously</strong> (<em>bool</em><em>, </em><em>optional</em>) – By default, an update will fail with
a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code> if the number of walkers is smaller than twice
the dimension of the problem because the walkers would then be
stuck on a low dimensional subspace. This can be avoided by
switching between the stretch move and, for example, a
Metropolis-Hastings step. If you want to do this and suppress the
error, set <code class="docutils literal notranslate"><span class="pre">live_dangerously</span> <span class="pre">=</span> <span class="pre">True</span></code>. Thanks goes (once again)
to &#64;dstndstn for this wonderful terminology.</p></li>
<li><p><strong>gibbs_sampling_leaves_per</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of individual leaves
to sample over during Gibbs Sampling. <code class="docutils literal notranslate"><span class="pre">None</span></code> means there will be
no Gibbs sampling. Currently, if you specify anything other than <code class="docutils literal notranslate"><span class="pre">None</span></code>,
it will split up different branches automatically and then Gibbs sample
over each branch indivudally. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code> are passed to <a class="reference internal" href="#eryn.moves.Move" title="eryn.moves.Move"><code class="xref py py-class docutils literal notranslate"><span class="pre">Move</span></code></a> class.</p>
<dl class="py method">
<dt id="eryn.moves.RedBlueMove.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Any setup necessary for the proposal</p>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.RedBlueMove.get_proposal">
<em class="property">classmethod </em><code class="sig-name descname">get_proposal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sample</span></em>, <em class="sig-param"><span class="n">complement</span></em>, <em class="sig-param"><span class="n">random</span></em>, <em class="sig-param"><span class="n">inds</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a proposal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[subset size, nleaves_max, ndim]. This is the subset
whose <code class="docutils literal notranslate"><span class="pre">coords</span></code> are being proposed.</p></li>
<li><p><strong>complement</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are lists of other
other np.ndarray[nwalkers - subset size, nleaves_max, ndim] from
all other subsets. This is the compliment whose <code class="docutils literal notranslate"><span class="pre">coords</span></code> are
used to form the proposal for the <code class="docutils literal notranslate"><span class="pre">sample</span></code> subset.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state of the sampler.</p></li>
<li><p><strong>inds</strong> (<em>dict</em><em>, </em><em>optional</em>) – # TODO check this.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple contained proposal information.</dt><dd><p>First entry is the new coordinates as a dictionary with keys
as <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values as np.ndarray[subset size, ndim * nleaves_max]
of new coordinates. Second entry is the factors associated with the
proposal necessary for detailed balance. This is effectively
any term in the detailed balance fraction. +log of factors if
in the numerator. -log of factors if in the denominator.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.RedBlueMove.propose">
<code class="sig-name descname">propose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.RedBlueMove.compute_log_posterior_basic">
<code class="sig-name descname">compute_log_posterior_basic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logl</span></em>, <em class="sig-param"><span class="n">logp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.RedBlueMove.tune">
<code class="sig-name descname">tune</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">accepted</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.RedBlueMove.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_state</span></em>, <em class="sig-param"><span class="n">new_state</span></em>, <em class="sig-param"><span class="n">accepted</span></em>, <em class="sig-param"><span class="n">subset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
necessary for global fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>old_state</strong> – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="implemented-red-blue-moves">
<h3>Implemented Red-Blue Moves<a class="headerlink" href="#implemented-red-blue-moves" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="eryn.moves.StretchMove">
<em class="property">class </em><code class="sig-prename descclassname">eryn.moves.</code><code class="sig-name descname">StretchMove</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.red_blue.RedBlueMove</span></code></p>
<p>Affine-Invariant Proposal</p>
<p>A <a class="reference external" href="https://msp.org/camcos/2010/5-1/p04.xhtml">Goodman &amp; Weare (2010)</a> “stretch move” with
parallelization as described in <a class="reference external" href="https://arxiv.org/abs/1202.3665">Foreman-Mackey et al. (2013)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (<em>double</em><em>, </em><em>optional</em>) – The stretch scale parameter. (default: <code class="docutils literal notranslate"><span class="pre">2.0</span></code>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="eryn.moves.StretchMove.a">
<code class="sig-name descname">a</code><a class="headerlink" href="#eryn.moves.StretchMove.a" title="Permalink to this definition">¶</a></dt>
<dd><p>The stretch scale parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.StretchMove.get_proposal">
<code class="sig-name descname">get_proposal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s_all</span></em>, <em class="sig-param"><span class="n">c_all</span></em>, <em class="sig-param"><span class="n">random</span></em>, <em class="sig-param"><span class="n">inds_s</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inds_c</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate stretch proposal</p>
<p># TODO: add log proposal from ptemcee</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_all</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are coordinates
for which a proposal is to be generated.</p></li>
<li><p><strong>c_all</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are lists. These
lists contain all the complement array values.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Random state object.</p></li>
<li><p><strong>inds_s</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[nwalkers, nleaves_max] that indicate which leaves
are currently being used in <code class="code docutils literal notranslate"><span class="pre">s_all</span></code>. (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>inds_c</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[nwalkers, nleaves_max] that indicate which leaves
are currently being used in <code class="code docutils literal notranslate"><span class="pre">s_all</span></code>. (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>First entry is new positions. Second entry is detailed balance factors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Issues with dimensionality.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.StretchMove.compute_log_posterior_basic">
<code class="sig-name descname">compute_log_posterior_basic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logl</span></em>, <em class="sig-param"><span class="n">logp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.StretchMove.propose">
<code class="sig-name descname">propose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.StretchMove.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Any setup necessary for the proposal</p>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.StretchMove.tune">
<code class="sig-name descname">tune</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">accepted</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.StretchMove.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_state</span></em>, <em class="sig-param"><span class="n">new_state</span></em>, <em class="sig-param"><span class="n">accepted</span></em>, <em class="sig-param"><span class="n">subset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
necessary for global fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>old_state</strong> – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="reversible-jump-moves">
<h2>Reversible Jump Moves<a class="headerlink" href="#reversible-jump-moves" title="Permalink to this headline">¶</a></h2>
<div class="section" id="reversible-jump-parent-class">
<h3>Reversible Jump Parent Class<a class="headerlink" href="#reversible-jump-parent-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="eryn.moves.ReversibleJump">
<em class="property">class </em><code class="sig-prename descclassname">eryn.moves.</code><code class="sig-name descname">ReversibleJump</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_k</span></em>, <em class="sig-param"><span class="n">min_k</span></em>, <em class="sig-param"><span class="n">proposal</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dr_max_iter</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">tune</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.move.Move</span></code></p>
<p>An abstract reversible jump move from # TODO: add citations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_k</strong> (<em>int</em><em> or </em><em>list of int</em>) – Maximum number(s) of leaves for each model.</p></li>
<li><p><strong>min_k</strong> (<em>int</em><em> or </em><em>list of int</em>) – Minimum number(s) of leaves for each model.</p></li>
<li><p><strong>tune</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, tune proposal. (Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="eryn.moves.ReversibleJump.tune">
<code class="sig-name descname">tune</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">accepted</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.ReversibleJump.get_proposal">
<code class="sig-name descname">get_proposal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">all_coords</span></em>, <em class="sig-param"><span class="n">all_inds</span></em>, <em class="sig-param"><span class="n">all_inds_for_change</span></em>, <em class="sig-param"><span class="n">random</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a proposal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_coords</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max, ndim]. These are the curent
coordinates for all the walkers.</p></li>
<li><p><strong>all_inds</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max]. These are the boolean
arrays marking which leaves are currently used within each walker.</p></li>
<li><p><strong>all_inds_for_change</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
dictionaries. These dictionaries have keys <code class="docutils literal notranslate"><span class="pre">&quot;+1&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>,
indicating waklkers that are adding or removing a leafm respectively.
The values for these dicts are <code class="docutils literal notranslate"><span class="pre">int</span></code> np.ndarray[…, 3]. The “…” indicates
the number of walkers in all temperatures that fall under either adding
or removing a leaf. The second dimension, 3, is the indexes into
the three-dimensional arrays within <code class="docutils literal notranslate"><span class="pre">all_inds</span></code> of the specific leaf
that is being added or removed from those leaves currently considered.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple containing proposal information.</dt><dd><p>First entry is the new coordinates as a dictionary with keys
as <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values as
<code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">``</span> <span class="pre">np.ndarray[ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim]</span> <span class="pre">containing</span>
<span class="pre">proposed</span> <span class="pre">coordinates.</span> <span class="pre">Second</span> <span class="pre">entry</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">``inds</span></code> array with
boolean values flipped for added or removed sources. Third entry
is the factors associated with the
proposal necessary for detailed balance. This is effectively
any term in the detailed balance fraction. +log of factors if
in the numerator. -log of factors if in the denominator.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If this proposal is not implemented by a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.ReversibleJump.compute_log_posterior_basic">
<code class="sig-name descname">compute_log_posterior_basic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logl</span></em>, <em class="sig-param"><span class="n">logp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.ReversibleJump.propose">
<code class="sig-name descname">propose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.ReversibleJump.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_state</span></em>, <em class="sig-param"><span class="n">new_state</span></em>, <em class="sig-param"><span class="n">accepted</span></em>, <em class="sig-param"><span class="n">subset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
necessary for global fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>old_state</strong> – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="implemented-reversible-jump-moves">
<h3>Implemented Reversible Jump Moves<a class="headerlink" href="#implemented-reversible-jump-moves" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="eryn.moves.PriorGenerate">
<em class="property">class </em><code class="sig-prename descclassname">eryn.moves.</code><code class="sig-name descname">PriorGenerate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">priors</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.PriorGenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.rj.ReversibleJump</span></code></p>
<p>Generate Revesible-Jump proposals from prior</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>priors</strong> (<em>object</em>) – <code class="xref py py-class docutils literal notranslate"><span class="pre">PriorContainer</span></code> object that has <code class="docutils literal notranslate"><span class="pre">logpdf</span></code>
and <code class="docutils literal notranslate"><span class="pre">rvs</span></code> methods.</p>
</dd>
</dl>
<dl class="py method">
<dt id="eryn.moves.PriorGenerate.get_proposal">
<code class="sig-name descname">get_proposal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">all_coords</span></em>, <em class="sig-param"><span class="n">all_inds</span></em>, <em class="sig-param"><span class="n">all_inds_for_change</span></em>, <em class="sig-param"><span class="n">random</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.PriorGenerate.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a proposal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_coords</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max, ndim]. These are the curent
coordinates for all the walkers.</p></li>
<li><p><strong>all_inds</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max]. These are the boolean
arrays marking which leaves are currently used within each walker.</p></li>
<li><p><strong>all_inds_for_change</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
dictionaries. These dictionaries have keys <code class="docutils literal notranslate"><span class="pre">&quot;+1&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>,
indicating waklkers that are adding or removing a leafm respectively.
The values for these dicts are <code class="docutils literal notranslate"><span class="pre">int</span></code> np.ndarray[…, 3]. The “…” indicates
the number of walkers in all temperatures that fall under either adding
or removing a leaf. The second dimension, 3, is the indexes into
the three-dimensional arrays within <code class="docutils literal notranslate"><span class="pre">all_inds</span></code> of the specific leaf
that is being added or removed from those leaves currently considered.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple containing proposal information.</dt><dd><p>First entry is the new coordinates as a dictionary with keys
as <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values as
<code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">``</span> <span class="pre">np.ndarray[ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim]</span> <span class="pre">containing</span>
<span class="pre">proposed</span> <span class="pre">coordinates.</span> <span class="pre">Second</span> <span class="pre">entry</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">``inds</span></code> array with
boolean values flipped for added or removed sources. Third entry
is the factors associated with the
proposal necessary for detailed balance. This is effectively
any term in the detailed balance fraction. +log of factors if
in the numerator. -log of factors if in the denominator.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.PriorGenerate.compute_log_posterior_basic">
<code class="sig-name descname">compute_log_posterior_basic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logl</span></em>, <em class="sig-param"><span class="n">logp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.PriorGenerate.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.PriorGenerate.propose">
<code class="sig-name descname">propose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.PriorGenerate.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.PriorGenerate.tune">
<code class="sig-name descname">tune</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">accepted</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.PriorGenerate.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="eryn.moves.PriorGenerate.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_state</span></em>, <em class="sig-param"><span class="n">new_state</span></em>, <em class="sig-param"><span class="n">accepted</span></em>, <em class="sig-param"><span class="n">subset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.PriorGenerate.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
necessary for global fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>old_state</strong> – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="prior.html" class="btn btn-neutral float-right" title="Priors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="backend.html" class="btn btn-neutral float-left" title="Backends" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, Michael Katz and Nikos Karnesis

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>